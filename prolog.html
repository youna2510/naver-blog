<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="prolog.css">
    <title>SG Blog</title>

    <script>
        function popup(){
            var url = "./neighbor_request.html";
            var name = "_blank";
            var option = "width = 480, height = 300, top = 100, left = 200, location = no"
            window.open(url, name, option);
        }
    </script>
</head>
<body>
    <div class="top_menubar">
        <a>ë‚´ ë¸”ë¡œê·¸</a>
        <a style="color: gray;"> | </a>
        <a>ì´ì›ƒ ë¸”ë¡œê·¸</a>
        <a style="color: gray;"> | </a>
        <a style="color:black; text-decoration-line: none;" href="./main.html">ë¸”ë¡œê·¸ í™ˆ</a>
        <a style="color: gray;"> | </a>
        <a href="./login.html" class="login_btn">ë¡œê·¸ì¸</a>
    </div>
 
    <div class="itemtitlefont" id="blogTitleName">ë¸”ë¡œê·¸ ì œëª©ì…ë‹ˆë‹¹</div>


<div id="blog-menu">
    <div class="border">
        <table>
            <tbody><tr><td nowrap="nowrap" class="menu1">
                <ul>
                    <li>                        
                        <a style="color : #861f1c;  font-weight: bold;">í”„ë¡¤ë¡œê·¸</a>
                    </li>
                    <li> | </li>
                    <li>                       
                        <a id="blog-link" href="#" style="color:black; text-decoration-line: none;">ë¸”ë¡œê·¸</a>
                    </li>      
                </ul>
            </td></tr></tbody>
        </table>
</div>
</div>
<hr style="margin-left: 140px;">
</div>

    
<!--í”„ë¡œí•„-->
<div class="bg-body"> 
    <div class="con"> 
        <p class="image"> 
            <a href="#" >
                <img class="user-profilepicture" style="width:135px;" src="assets/profile.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
            </a> 
        </p> 
    </div> 
    <div class="name align"> 
        <div class="user-nickname" style="font-size: 15px;"> <strong class="itemfont col" id="nickNameArea">ì‚¬ìš©ìì´ë¦„</strong>
                <br> <span class="itemfont col">
                    <span class="blog_domain col"> </span> </span> 
                
            </div> 
        </div> <p class="caption align"> 
            <span class="itemfont_col">í”„ë¡œí•„ ì†Œê°œ</span>
            </p>
                <p class="more align"> <span class="m1">
        </p> 
        <div class="btn_area" onclick="popup()"> 
            <a> 
                <span class="blind">ì´ì›ƒì¶”ê°€</span> 
            </a> 
        </div> 
    </div> 
</div>

<!--ì„œë¡œì´ì›ƒ-->
<div class="bg-neighbor"> 
    <div class="neighbor-profile">
        <div class="user-nickname" style = "font-size: 15px;"><strong>ì‚¬ìš©ì</strong></div>
        <div>ì´ì›ƒ ì»¤ë„¥íŠ¸</div>
        <hr style="width:100%; border: 0.25px solid gray;">
    </div>
    <div class="neighbor-list"> 
        <div style="display: none;">
            <a class="find_neighbor">ë‚´ê°€ ì¶”ê°€í•œ</a><a class="find_neighbor">ë‚˜ë¥¼ ì¶”ê°€í•œ</a>
        </div>
        <div class="all_neighborhood">
            <a>ì „ì²´ ì´ì›ƒ</a><a style="margin-left: 80px;">57</a><a>ëª…</a>
        </div>   
        <div style="display:inline-block;">
            <div class="neighbor_img"><img></div>
            <a class="neighbor_nickname">ì´ì›ƒë³„ëª…</a>
        </div>
        <div style="display:inline-block;">
            <div class="neighbor_img"><img></div>
            <a class="neighbor_nickname">ì´ì›ƒë³„ëª…</a>
        </div>
        <div style="display:inline-block;">
            <div class="neighbor_img"><img></div>
            <a class="neighbor_nickname">ì´ì›ƒë³„ëª…</a>
        </div>
        <br>     
        <div>
            <hr style="width:80%; border: 0.25px solid gray;">
            <a class="user-nickname" style="margin-left:10px; font-size: 13px; color:gray"><strong>ë©˜ì•„</strong>ë‹˜ ì´ì›ƒì˜ ìƒˆê¸€ë³´ê¸° ></a>
        </div>
    </div> 
</div>



<div class="pro_posts">
    <!--ê¸€1 -->

    <div class="pro_sy1">
        <p class="p_img">            
            <a href="https://blog.naver.com/PostView.naver?blogId=men_mena&amp;logNo=223724607681&amp;redirect=Dlog">
                <img src="https://blogthumb.pstatic.net/MjAyNDA3MzFfMjk3/MDAxNzIyNDEwNDQwNDIx.m_AaNJZuA2mOl3Rvw8Rj8ZcwgsF6AXJJR8Icfgvs_M8g.TOWdhE3DcF4SP6m9dUq24BMgt-f_YwpvUw5V_FeOnLEg.JPEG/20240730%25A3%25DF075525.jpg?type=s2" width="183" height="185" title="[CampOn] 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ë©˜í†  ì°¸ì—¬ í›„ê¸°" alt="[CampOn] 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ë©˜í†  ì°¸ì—¬ í›„ê¸°" onerror="this.onerror=null;this.src='https://blogimgs.pstatic.net/nblog/prologue/thumb_183_185.gif'">
            </a>
        </p>
        <ul>
            <li class="p_title">
                <a class="p_title_t">[CampOn] 2024 ì‚¼...</a>
                <span class="num_comments">[2]</span>
            </li>
            <li class="p_con">
                <a class="pcol_contents">
                ì•ˆë…•í•˜ì„¸ìš”, ë©˜ì•„ì…ë‹ˆë‹¤! ì´ë²ˆì—ëŠ” ì˜¬í•´ ë°©í•™ ë•Œ ë‹¤ë…€ì˜¨ 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ì°¸ì—¬ í›„ê¸°ë¥¼ ì¨ë³¼ê¹Œí•´ìš”~! ë™ì•„ë¦¬ì›ë“¤ê³¼ ì œëŒ€ë¡œ...
                </a>
            </li>
            <li class="p_date">
                <span class="pcol2 itemfont fil5">2025. 1. 13.</span>
                
            </li>
        </ul>
    </div>

    <!--ê¸€2 -->
    <div class="pro_sy1">
        <p class="p_img">            
            <a href="https://blog.naver.com/PostView.naver?blogId=men_mena&amp;logNo=223724607681&amp;redirect=Dlog">
                <img src="https://blogthumb.pstatic.net/MjAyNDA3MzFfMjk3/MDAxNzIyNDEwNDQwNDIx.m_AaNJZuA2mOl3Rvw8Rj8ZcwgsF6AXJJR8Icfgvs_M8g.TOWdhE3DcF4SP6m9dUq24BMgt-f_YwpvUw5V_FeOnLEg.JPEG/20240730%25A3%25DF075525.jpg?type=s2" width="183" height="185">

            </a>
        </p>
        <ul>
            <li class="p_title">
                <a class="p_title_t">[CampOn] 2024 ì‚¼...</a>
                <span class="num_comments">[2]</span>
            </li>
            <li class="p_con">
                <a class="pcol_contents">
                ì•ˆë…•í•˜ì„¸ìš”, ë©˜ì•„ì…ë‹ˆë‹¤! ì´ë²ˆì—ëŠ” ì˜¬í•´ ë°©í•™ ë•Œ ë‹¤ë…€ì˜¨ 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ì°¸ì—¬ í›„ê¸°ë¥¼ ì¨ë³¼ê¹Œí•´ìš”~! ë™ì•„ë¦¬ì›ë“¤ê³¼ ì œëŒ€ë¡œ...
                </a>
            </li>
            <li class="p_date">
                <span class="pcol2 itemfont fil5">2025. 1. 13.</span>
                
            </li>
        </ul>
    </div>

    
    
    <div class="pro_sy2">
        <div class="clear">
                <p class="p_img2">
                    <a href="https://blog.naver.com/PostView.naver?blogId=men_mena&amp;logNo=223705422469&amp;redirect=Dlog"><img src="https://blogthumb.pstatic.net/MjAyNDA5MjNfMTA2/MDAxNzI3MDUxOTA5OTk5.rWhn4IGQ_zkYWYScdKu4yUzwkissZCDMjvyK7zmggkIg.l3_biO24DMNqb-UosVsDsbobMJLetRGBLbrgg3xdHRgg.JPEG/20240921%25A3%25DF230958.jpg?type=s1" width="90" height="90" title="[ì¼ìƒ] ë‹¤ì‹œ ê°œê°•í•œ ëŒ€í•™ìƒì˜ 9ì›”ê¸°" alt="[ì¼ìƒ] ë‹¤ì‹œ ê°œê°•í•œ ëŒ€í•™ìƒì˜ 9ì›”ê¸°" onerror="this.onerror=null;this.src='https://blogimgs.pstatic.net/nblog/prologue/thumb_90_90.jpg'">                    
                    </a>
                </p>
            <ul>
                <li class="p_title">
                    <a class="p_title_t">[CampOn] 2024 ì‚¼...</a>
                    <span class="num_comments">[2]</span>
                </li>
                <li class="p_con">
                    <a class="pcol_contents">
                    ì•ˆë…•í•˜ì„¸ìš”, ë©˜ì•„ì…ë‹ˆë‹¤! ì´ë²ˆì—ëŠ” ì˜¬í•´ ë°©í•™ ë•Œ ë‹¤ë…€ì˜¨ 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ì°¸ì—¬ í›„ê¸°ë¥¼ ì¨ë³¼ê¹Œí•´ìš”~! ë™ì•„ë¦¬ì›ë“¤ê³¼ ì œëŒ€ë¡œ...
                    </a>
                </li>
                <li class="p_date">
                    <span class="pcol2 itemfont fil5">2025. 1. 13.</span>
                    
                </li>
            </ul>
        </div>

        <div class="clear">
            <p class="p_img2">
                <a href="https://blog.naver.com/PostView.naver?blogId=men_mena&amp;logNo=223705422469&amp;redirect=Dlog"><img src="https://blogthumb.pstatic.net/MjAyNDA5MjNfMTA2/MDAxNzI3MDUxOTA5OTk5.rWhn4IGQ_zkYWYScdKu4yUzwkissZCDMjvyK7zmggkIg.l3_biO24DMNqb-UosVsDsbobMJLetRGBLbrgg3xdHRgg.JPEG/20240921%25A3%25DF230958.jpg?type=s1" width="90" height="90" title="[ì¼ìƒ] ë‹¤ì‹œ ê°œê°•í•œ ëŒ€í•™ìƒì˜ 9ì›”ê¸°" alt="[ì¼ìƒ] ë‹¤ì‹œ ê°œê°•í•œ ëŒ€í•™ìƒì˜ 9ì›”ê¸°" onerror="this.onerror=null;this.src='https://blogimgs.pstatic.net/nblog/prologue/thumb_90_90.jpg'">                    
                </a>
            </p>
        <ul>
            <li class="p_title">
                <a class="p_title_t">[CampOn] 2024 ì‚¼...</a>
                <span class="num_comments">[2]</span>
            </li>
            <li class="p_con">
                <a class="pcol_contents">
                ì•ˆë…•í•˜ì„¸ìš”, ë©˜ì•„ì…ë‹ˆë‹¤! ì´ë²ˆì—ëŠ” ì˜¬í•´ ë°©í•™ ë•Œ ë‹¤ë…€ì˜¨ 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ì°¸ì—¬ í›„ê¸°ë¥¼ ì¨ë³¼ê¹Œí•´ìš”~! ë™ì•„ë¦¬ì›ë“¤ê³¼ ì œëŒ€ë¡œ...
                </a>
            </li>
            <li class="p_date">
                <span class="pcol2 itemfont fil5">2025. 1. 13.</span>
                
            </li>
        </ul>
        </div>

        <div class="clear">
            <p class="p_img2">
                <a href="https://blog.naver.com/PostView.naver?blogId=men_mena&amp;logNo=223705422469&amp;redirect=Dlog"><img src="https://blogthumb.pstatic.net/MjAyNDA5MjNfMTA2/MDAxNzI3MDUxOTA5OTk5.rWhn4IGQ_zkYWYScdKu4yUzwkissZCDMjvyK7zmggkIg.l3_biO24DMNqb-UosVsDsbobMJLetRGBLbrgg3xdHRgg.JPEG/20240921%25A3%25DF230958.jpg?type=s1" width="90" height="90" title="[ì¼ìƒ] ë‹¤ì‹œ ê°œê°•í•œ ëŒ€í•™ìƒì˜ 9ì›”ê¸°" alt="[ì¼ìƒ] ë‹¤ì‹œ ê°œê°•í•œ ëŒ€í•™ìƒì˜ 9ì›”ê¸°" onerror="this.onerror=null;this.src='https://blogimgs.pstatic.net/nblog/prologue/thumb_90_90.jpg'">                    
                </a>
            </p>
        <ul>
            <li class="p_title">
                <a class="p_title_t">[CampOn] 2024 ì‚¼...</a>
                <span class="num_comments">[2]</span>
            </li>
            <li class="p_con">
                <a class="pcol_contents">
                ì•ˆë…•í•˜ì„¸ìš”, ë©˜ì•„ì…ë‹ˆë‹¤! ì´ë²ˆì—ëŠ” ì˜¬í•´ ë°©í•™ ë•Œ ë‹¤ë…€ì˜¨ 2024 ì‚¼ì‹œì„¸ë¼ in ê°€í‰ ì°¸ì—¬ í›„ê¸°ë¥¼ ì¨ë³¼ê¹Œí•´ìš”~! ë™ì•„ë¦¬ì›ë“¤ê³¼ ì œëŒ€ë¡œ...
                </a>
            </li>
            <li class="p_date">
                <span class="pcol2 itemfont fil5">2025. 1. 13.</span>
                
            </li>
        </ul>
        </div>        

    </div>    
</div>

<script>
    document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user");

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: usernameì´ ì—†ìŒ");
        document.getElementById("blog-title").innerText = "ë¸”ë¡œê·¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        document.getElementById("blog-intro").innerText = "ì˜¬ë°”ë¥¸ ì‚¬ìš©ì ì´ë¦„ì´ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
        return;
    }

    try {
        const accessToken = localStorage.getItem("access_token");
        if (!accessToken) {
            console.error("âŒ ì˜¤ë¥˜: accessTokenì´ ì—†ìŒ");
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            window.location.href = "login.html";
            return;
        }

        // ğŸ”¹ ë°±ì—”ë“œê°€ UTF-8 URL ì¸ì½”ë”©ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, ì •í™•í•˜ê²Œ ì¸ì½”ë”©ëœ URLì„ êµ¬ì„±
        const encodedUsername = encodeURIComponent(username);
        const apiUrl = `http://127.0.0.1:8000/profile/${encodedUsername}/`;

        console.log("ğŸ”¹ API ìš”ì²­ URL:", apiUrl);

        // ğŸ”¹ ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´ ì¡°íšŒ
        const response = await fetch(apiUrl, {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${accessToken}`,
                "Content-Type": "application/json"
            }
        });

        console.log("ğŸ”¹ API ì‘ë‹µ ìƒíƒœ ì½”ë“œ:", response.status);



        if (response.status === 200) {
            const data = await response.json();
            console.log("ğŸ”¹ API ì‘ë‹µ ë°ì´í„°:", data);

            const nickname = data.username || "ìµëª…"; // ë‹‰ë„¤ì„ ê°€ì ¸ì˜¤ê¸°
            const blogTitle = data.blog_name || "ë¸”ë¡œê·¸ëª…";
            const profilePic = data.user_pic || "assets/profile.png";
            const intro = data.intro || "ì´ ë¸”ë¡œê·¸ì— ëŒ€í•œ ì†Œê°œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";

            // ğŸ”¥ ë‹‰ë„¤ì„ ë³€ê²½
            document.querySelectorAll(".user-nickname").forEach(el => {
                                el.innerText = nickname;
            });

            // ğŸ”¥ í”„ë¡œí•„ ì‚¬ì§„ ë³€ê²½
            document.querySelectorAll(".user-profilepicture").forEach(img => {
                                img.src = profilePic;
            });

            document.querySelectorAll(".itemtitlefont").forEach(e2 => {
                e2.innerText = blogTitle;
            });


            document.querySelectorAll(".itemfont_col").forEach(e3 => {
                e3.innerText = intro;
            });

            document.getElementById("blog-title").innerText = blogTitle;
            document.getElementById("profile-pic").src = profilePic;
            document.getElementById("blog-intro").innerText = intro;
        } else {
            console.error("âŒ API ìš”ì²­ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ:", response.status);
            document.getElementById("blog-title").innerText = "ë¸”ë¡œê·¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
            document.getElementById("blog-intro").innerText = "ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        }
    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
        document.getElementById("blog-intro").innerText = "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
    }
});







document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user"); // í˜„ì¬ ë¸”ë¡œê·¸ ì£¼ì¸ì˜ username

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: usernameì´ ì—†ìŒ");
        return;
    }

    // ğŸ”¹ 'í”„ë¡¤ë¡œê·¸' ë§í¬ë¥¼ í•´ë‹¹ ë¸”ë¡œê·¸ ì£¼ì¸ì˜ í”„ë¡œë¡œê·¸ í˜ì´ì§€ë¡œ ì„¤ì •
    const blogLink = document.getElementById("blog-link");
    blogLink.href = `blog.html?user=${encodeURIComponent(username)}`;
});
    






function getFullMediaUrl(relativeUrl) {
    if (!relativeUrl) {
        return "assets/default_profile.png";  // ê¸°ë³¸ í”„ë¡œí•„ ì´ë¯¸ì§€
    }
    return `http://127.0.0.1:8000${relativeUrl}`;  // Django ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” ì ˆëŒ€ ê²½ë¡œ
}






//ì„œë¡œì´ì›ƒ ëª©ë¡ ì—°ë™

document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user"); // í˜„ì¬ ë³´ê³  ìˆëŠ” ë¸”ë¡œê·¸ ì£¼ì¸

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: ë¸”ë¡œê·¸ ì£¼ì¸ì˜ usernameì´ ì—†ìŒ");
        return;
    }


    try {
        // ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ ì¡°íšŒ API ìš”ì²­
        const apiUrl = `http://127.0.0.1:8000/profile/${encodeURIComponent(username)}/neighbors/`;
        console.log("ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ API í˜¸ì¶œ:", apiUrl);

        const response = await fetch(apiUrl, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        });

        if (response.status !== 200) {
            console.error("âŒ ì„œë¡œì´ì›ƒ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ:", response.status);
            return;
        }

        const data = await response.json();
        console.log("ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ ë°ì´í„°:", data);

        // ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ì„ UIì— ì¶”ê°€
        const neighborListContainer = document.querySelector(".neighbor-list");
        neighborListContainer.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

        if (data.neighbors.length === 0) {
            neighborListContainer.innerHTML = "<p>ì•„ì§ ì„œë¡œì´ì›ƒì´ ì—†ìŠµë‹ˆë‹¤.</p>";
            return;
        }

        data.neighbors.forEach(neighbor => {
    const neighborDiv = document.createElement("div");
    neighborDiv.style.display = "inline-block";

    const neighborImgDiv = document.createElement("div");
    neighborImgDiv.classList.add("neighbor_img");
    const img = document.createElement("img");

    img.src = getFullMediaUrl(neighbor.user_pic);  // user_picì„ ì ˆëŒ€ ê²½ë¡œë¡œ ë³€í™˜
    img.alt = "ì´ì›ƒ í”„ë¡œí•„";
    neighborImgDiv.appendChild(img);

    const neighborNickname = document.createElement("a");
    neighborNickname.classList.add("neighbor_nickname");
    neighborNickname.innerText = neighbor.urlname;
    neighborNickname.href = `blog.html?user=${encodeURIComponent(neighbor.urlname)}`;

    neighborDiv.appendChild(neighborImgDiv);
    neighborDiv.appendChild(neighborNickname);
    neighborListContainer.appendChild(neighborDiv);
});

    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
    }
});






</script>


</body>
</html>