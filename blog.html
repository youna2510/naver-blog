<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="prolog.css">
    <title>SG Blog</title>

    <script>
        function popup(){
            var url = "./neighbor_request.html";
            var name = "_blank";
            var option = "width = 480, height = 300, top = 100, left = 200, location = no"
            window.open(url, name, option);
        }
    </script>

</head>
<body>
    
    <div id="top-area">
        <div class="top_menubar">
            <a>ë‚´ ë¸”ë¡œê·¸</a>
            <a style="color: gray;"> | </a>
            <a>ì´ì›ƒ ë¸”ë¡œê·¸</a>
            <a style="color: gray;"> | </a>
            <a style="color:black; text-decoration-line: none;" href="./main.html">ë¸”ë¡œê·¸ í™ˆ</a>
            <a style="color: gray;"> | </a>
            <a href="./login.html" class="login_btn">ë¡œê·¸ì¸</a>
        </div>
 
              <div class="itemtitlefont" id="blogTitleName">ë¸”ë¡œê·¸ ì œëª©ì…ë‹ˆë‹¹</div>

        
        <div id="blog-menu">
            <div class="border">
                    <table>
                        <tbody><tr><td nowrap="nowrap" class="menu1">
                            <ul>
                                <li>                        
                                    <a id="prolog-link" href="#" style="color: black; text-decoration-line: none;">í”„ë¡¤ë¡œê·¸</a>
                                </li>
                                <li> | </li>
                                <li>                       
                                    <a style="color:#861f1c; font-weight: bold;">ë¸”ë¡œê·¸</a>
                                </li>      
                            </ul>
                        </td></tr></tbody>
                    </table>
            </div>
        </div>
        <hr style="margin-left: 140px;">
    </div>

    
<!--í”„ë¡œí•„-->
<div class="bg-body"> 
    <div class="con"> 
        <p class="image"> 
            <a href="#" >
                <img class="user-profilepicture" style="width:135px;" src="assets/profile.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
            </a> 
        </p> 
    </div> 
    <div class="name align"> 
        <div class="user-nickname" style="font-size: 15px;"> <strong class="itemfont col" id="nickNameArea">ì‚¬ìš©ìì´ë¦„</strong>
                <br> <span class="itemfont col">
                    <span class="blog_domain col"> </span> </span> 
                
            </div> 
        </div> <p class="caption align"> 
            <span class="itemfont_col">í”„ë¡œí•„ ì†Œê°œ</span>
            </p>
                <p class="more align"> <span class="m1">
        </p> 
        <div class="btn_area" onclick="popup()"> 
            <a> 
                <span class="blind">ì´ì›ƒì¶”ê°€</span> 
            </a> 
        </div> 
    </div> 
</div>


<!--ì¹´í…Œê³ ë¦¬-->
<div class="bg-category"> 
    <div class="category-list"> 
        <div>ì „ì²´ë³´ê¸°</div>
        <div>ê²Œì‹œíŒ1</div>
        <div>ê²Œì‹œíŒ2</div>
        <div>ê²Œì‹œíŒ3</div>

    </div> 
</div>

<!--ì„œë¡œì´ì›ƒ-->
<div class="bg-neighbor"> 
    <div class="neighbor-profile">
        <div class="user-nickname" style = "font-size: 15px;"><strong>ì‚¬ìš©ì</strong></div>
        <div>ì´ì›ƒ ì»¤ë„¥íŠ¸</div>
        <hr style="width:100%; border: 0.25px solid gray;">
    </div>
    <div class="neighbor-list"> 
        <div style="display: none;">
            <a class="find_neighbor">ë‚´ê°€ ì¶”ê°€í•œ</a><a class="find_neighbor">ë‚˜ë¥¼ ì¶”ê°€í•œ</a>
        </div>
        <div class="all_neighborhood">
            <a>ì „ì²´ ì´ì›ƒ</a><a style="margin-left: 80px;">57</a><a>ëª…</a>
        </div>   
        <div style="display:inline-block;">
            <div class="neighbor_img"><img></div>
            <a class="neighbor_nickname">ì´ì›ƒë³„ëª…</a>
        </div>
        <div style="display:inline-block;">
            <div class="neighbor_img"><img></div>
            <a class="neighbor_nickname">ì´ì›ƒë³„ëª…</a>
        </div>
        <div style="display:inline-block;">
            <div class="neighbor_img"><img></div>
            <a class="neighbor_nickname">ì´ì›ƒë³„ëª…</a>
        </div>
        <br>     
        <div>
            <hr style="width:80%; border: 0.25px solid gray;">
            <a class="user-nickname" style="margin-left:10px; font-size: 13px; color:gray"><strong>ë©˜ì•„</strong>ë‹˜ ì´ì›ƒì˜ ìƒˆê¸€ë³´ê¸° ></a>
        </div>
    </div> 
</div>




<!--í¬ìŠ¤íŠ¸ ëª©ë¡-->
<div class="pro_posts">
    <div class="post_list">
        <div class="post_list_title">
            <strong>ì „ì²´ë³´ê¸°</strong> <a>5ê°œì˜ ê¸€</a>
            <a class="list_open"> ëª©ë¡ ì—´ê¸° </a>
        </div>
        <div style="display:none;" class="post_list_contents">
            <div class="post_list_content_title">
                <a>ê¸€ ì œëª©</a><a style="float:right;">ì‘ì„±ì¼</a>
            </div>
            <hr class="post_list_hr">
            <div class="post_list_contents_list">
                <div>
                    <a>ê¸€ ì œëª©1</a><a style="float:right;">2024.02.10</a>
                    <hr class="post_list_contents_hr">
                </div>
                <div>
                    <a>ê¸€ ì œëª©2</a><a style="float:right;">2024.02.10</a>
                    <hr class="post_list_contents_hr">
                </div>
                <div>
                    <a>ê¸€ ì œëª©3</a><a style="float:right;">2024.02.10</a>
                    <hr class="post_list_contents_hr">
                </div>
                <div>
                    <a>ê¸€ ì œëª©4</a><a style="float:right;">2024.02.10</a>
                    <hr class="post_list_contents_hr">
                </div>
                <div>
                    <a>ê¸€ ì œëª©5</a><a style="float:right;">2024.02.10</a>
                    <hr class="post_list_contents_hr">
                </div>
                <div class="post_list_page">
                    <ul class="pagination">
                        <li><a href="#" class="left"> <ì´ì „ </a></li>
                        <li><a href="#" class="active num">1</a></li>
                        <li><a href="#" class="num">2</a></li>
                        <li><a href="#" class="num">3</a></li>
                        <li><a href="#" class="num">4</a></li>
                        <li><a href="#" class="num">5</a></li>
                        <li><a href="#" class="num">6</a></li>
                        <li><a href="#" class="num">7</a></li>
                        <li><a href="#" class="num">8</a></li>
                        <li><a href="#" class="right">ë‹¤ìŒ></a></li>

                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="post_content">
        <div class="post_title_content">
            <div class="post_category">[ë¸”ì²¼] ì¼ìƒ í¬í† ë¤í”„</div>
            <div class="post_title"> ê¸€ ì œëª© </div>
            <div class="post_writer_list">
                <strong class="user-nickname" style="color: black;">ë©˜ì•„</strong>&nbsp;<a>2024. 9. 24. 23:21</a>
                <a class="neighbor_insert">+ì´ì›ƒì¶”ê°€</a><a style="float:right; padding-right: 10px;">URL ë³µì‚¬</a>
            </div>
            <hr class="post_hr">
        </div>
        <div class="post_contents">
            ê¸€ê¸€ê¸€
        </div>
        <div class="post_last_list">
            <a class="heart_list">ê³µê° 4</a>
            <a class="comment_list">ëŒ“ê¸€ ì“°ê¸°</a>
        </div>
        <div class="comments">
            <div class="writed_comments">
                <a class="cmt_writer_nickname"><strong>ë‹‰ë„¤ì„1</strong></a>
                <div class="writing_comment">ê¸€ ì¢‹ì•„ìš”~</div>
                <div style="margin-left: 5px; margin-top: 10px;" class="comment_btns">
                    <a class="another_cmts"><strong>ë‹µê¸€</strong></a>
                </div>
                <hr style="margin-top:20px; margin-left:20px; width:95%; border: solid 0.25px gray;">
            </div>
            <div class="writed_comments">
                <a class="cmt_writer_nickname"><strong>ë‹‰ë„¤ì„1</strong></a>
                <div class="writing_comment">ê¸€ ì¢‹ì•„ìš”~</div>
                <div style="margin-left: 5px; margin-top: 10px;" class="comment_btns">
                    <a class="another_cmts"><strong>ë‹µê¸€</strong></a>
                </div>
                <hr style="margin-top:20px; margin-left:20px; width:95%; border: solid 0.25px gray;">
            </div>

            <div style="margin-left: 45%;" >
                <ul class="pagination">
                    <li><a href="#" class="active num">1</a></li>
                    <li><a href="#" class="num">2</a></li>
                </ul>
            </div>

            <div class="comment_write">
                <a class="cmt_writer_nickname"><strong>ë‹‰ë„¤ì„</strong></a>
                <div class="writing_comment">
                    <textarea class="writing_comment_input" type="text" id="comment" name="comment" placeholder="ë¸”ë¡œê·¸ê°€ ë” í›ˆí›ˆí•´ì§€ëŠ” ëŒ“ê¸€ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ë¶ˆì¾Œê°ì„ ì£¼ëŠ” ìš•ì„¤ê³¼ ì•…í”Œì€ ì‚­ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."></textarea>
                </div>
                <hr class="comment_hr">
                <div class="comment_btns">
                    <a>ìŠ¤í‹°ì»¤</a><a>ì‚¬ì§„</a><a>ë¹„ë°€ëŒ“ê¸€</a>
                    <a class="submit_cmt"><strong>ë“±ë¡</strong></a>
                </div>
            </div>
        </div>
    </div>
    <div class="list_page">
        <ul class="pagination">
            <li><a href="#" class="left"> <ì´ì „ </a></li>
            <li><a href="#" class="active num">1</a></li>
            <li><a href="#" class="num">2</a></li>
            <li><a href="#" class="num">3</a></li>
            <li><a href="#" class="num">4</a></li>
            <li><a href="#" class="num">5</a></li>
            <li><a href="#" class="num">6</a></li>
            <li><a href="#" class="num">7</a></li>
            <li><a href="#" class="num">8</a></li>
            <li><a href="#" class="right">ë‹¤ìŒ></a></li>
    
        </ul>
    </div>
    
</div>

<script>

    document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user");

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: usernameì´ ì—†ìŒ");
        document.getElementById("blog-title").innerText = "ë¸”ë¡œê·¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        document.getElementById("blog-intro").innerText = "ì˜¬ë°”ë¥¸ ì‚¬ìš©ì ì´ë¦„ì´ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
        return;
    }

    try {
        const accessToken = localStorage.getItem("access_token");
        if (!accessToken) {
            console.error("âŒ ì˜¤ë¥˜: accessTokenì´ ì—†ìŒ");
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            window.location.href = "login.html";
            return;
        }

        // ğŸ”¹ ë°±ì—”ë“œê°€ UTF-8 URL ì¸ì½”ë”©ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, ì •í™•í•˜ê²Œ ì¸ì½”ë”©ëœ URLì„ êµ¬ì„±
        const encodedUsername = encodeURIComponent(username);
        const apiUrl = `http://127.0.0.1:8000/profile/${encodedUsername}/`;

        console.log("ğŸ”¹ API ìš”ì²­ URL:", apiUrl);

        // ğŸ”¹ ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´ ì¡°íšŒ
        const response = await fetch(apiUrl, {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${accessToken}`,
                "Content-Type": "application/json"
            }
        });

        console.log("ğŸ”¹ API ì‘ë‹µ ìƒíƒœ ì½”ë“œ:", response.status);



        if (response.status === 200) {
            const data = await response.json();
            console.log("ğŸ”¹ API ì‘ë‹µ ë°ì´í„°:", data);

            const nickname = data.username || "ìµëª…"; // ë‹‰ë„¤ì„ ê°€ì ¸ì˜¤ê¸°
            const blogTitle = data.blog_name || "ë¸”ë¡œê·¸ëª…";
            const profilePic = data.user_pic || "assets/profile.png";
            const intro = data.intro || "ì´ ë¸”ë¡œê·¸ì— ëŒ€í•œ ì†Œê°œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";

            // ğŸ”¥ ë‹‰ë„¤ì„ ë³€ê²½
            document.querySelectorAll(".user-nickname").forEach(el => {
                                el.innerText = nickname;
            });

            // ğŸ”¥ í”„ë¡œí•„ ì‚¬ì§„ ë³€ê²½
            document.querySelectorAll(".user-profilepicture").forEach(img => {
                                img.src = profilePic;
            });

            document.querySelectorAll(".itemtitlefont").forEach(e2 => {
                e2.innerText = blogTitle;
            });


            document.querySelectorAll(".itemfont_col").forEach(e3 => {
                e3.innerText = intro;
            });





            document.getElementById("blog-title").innerText = blogTitle;
            document.getElementById("profile-pic").src = profilePic;
            document.getElementById("blog-intro").innerText = intro;
        } else {
            console.error("âŒ API ìš”ì²­ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ:", response.status);
            document.getElementById("blog-title").innerText = "ë¸”ë¡œê·¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
            document.getElementById("blog-intro").innerText = "ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        }
    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
        document.getElementById("blog-intro").innerText = "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
    }
});








document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user"); // ì´ì›ƒ ì‹ ì²­ì„ ë°›ëŠ” ì‚¬ëŒ (ë¸”ë¡œê·¸ ì£¼ì¸)

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: usernameì´ ì—†ìŒ");
        document.getElementById("blog-title").innerText = "ë¸”ë¡œê·¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        document.getElementById("blog-intro").innerText = "ì˜¬ë°”ë¥¸ ì‚¬ìš©ì ì´ë¦„ì´ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
        return;
    }

    try {
        const accessToken = localStorage.getItem("access_token");
        if (!accessToken) {
            console.error("âŒ ì˜¤ë¥˜: accessTokenì´ ì—†ìŒ");
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            window.location.href = "login.html";
            return;
        }

        // ğŸ”¹ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        const userResponse = await fetch("http://127.0.0.1:8000/profile/me/", {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${accessToken}`,
                "Content-Type": "application/json"
            }
        });

        if (userResponse.status !== 200) {
            console.error("âŒ ì‚¬ìš©ì ì •ë³´ ìš”ì²­ ì‹¤íŒ¨:", userResponse.status);
            alert("ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }

        const userData = await userResponse.json();
        const loggedInUser = userData.username; // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ë‹‰ë„¤ì„

        console.log("ğŸ”¹ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì:", loggedInUser);
        console.log("ğŸ”¹ ë¸”ë¡œê·¸ ì£¼ì¸:", username);

        // ğŸ”¥ 'ì´ì›ƒ ì¶”ê°€' ë²„íŠ¼ í´ë¦­ ì‹œ API í˜¸ì¶œ
        document.getElementById("add-neighbor-btn").addEventListener("click", async function () {
            // ì„œë¡œì´ì›ƒ ìš”ì²­ ë©”ì‹œì§€
            const requestMessage = prompt("ì´ì›ƒ ì‹ ì²­ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”:", "ì¹œí•˜ê²Œ ì§€ë‚´ê³  ì‹¶ì–´ìš”!");

            if (!requestMessage) {
                alert("ì´ì›ƒ ì‹ ì²­ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.");
                return;
            }

            try {
                const apiUrl = `http://127.0.0.1:8000/neighbors/${encodeURIComponent(username)}/`;

                console.log("ğŸ”¹ ì„œë¡œì´ì›ƒ ì‹ ì²­ API í˜¸ì¶œ:", apiUrl);

                const response = await fetch(apiUrl, {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${accessToken}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        request_message: requestMessage
                    })
                });

                if (response.status === 201) {
                    alert("âœ… ì´ì›ƒ ì‹ ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
                } else {
                    console.error("âŒ ì´ì›ƒ ì‹ ì²­ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ:", response.status);
                    alert("ì´ì›ƒ ì‹ ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                }
            } catch (error) {
                console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
                alert("ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
        });

    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
        document.getElementById("blog-intro").innerText = "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
    }
});

// ğŸ”¹ 'ì´ì›ƒ ì¶”ê°€' ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—… ì—´ê¸°
function popup() {
    var url = "./neighbor_request.html";
    var name = "_blank";
    var option = "width=480, height=300, top=100, left=200, location=no";
    window.open(url, name, option);
}







document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user"); // í˜„ì¬ ë¸”ë¡œê·¸ ì£¼ì¸ì˜ username

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: usernameì´ ì—†ìŒ");
        return;
    }

    // ğŸ”¹ 'í”„ë¡¤ë¡œê·¸' ë§í¬ë¥¼ í•´ë‹¹ ë¸”ë¡œê·¸ ì£¼ì¸ì˜ í”„ë¡œë¡œê·¸ í˜ì´ì§€ë¡œ ì„¤ì •
    const prologLink = document.getElementById("prolog-link");
    prologLink.href = `prolog.html?user=${encodeURIComponent(username)}`;
});






function getFullMediaUrl(relativeUrl) {
    if (!relativeUrl) {
        return "assets/default_profile.png";  // ê¸°ë³¸ í”„ë¡œí•„ ì´ë¯¸ì§€
    }
    return `http://127.0.0.1:8000${relativeUrl}`;  // Django ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” ì ˆëŒ€ ê²½ë¡œ
}






//ì„œë¡œì´ì›ƒ ëª©ë¡ ì—°ë™

document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user"); // í˜„ì¬ ë³´ê³  ìˆëŠ” ë¸”ë¡œê·¸ ì£¼ì¸

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: ë¸”ë¡œê·¸ ì£¼ì¸ì˜ usernameì´ ì—†ìŒ");
        return;
    }


    try {
        // ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ ì¡°íšŒ API ìš”ì²­
        const apiUrl = `http://127.0.0.1:8000/profile/${encodeURIComponent(username)}/neighbors/`;
        console.log("ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ API í˜¸ì¶œ:", apiUrl);

        const response = await fetch(apiUrl, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        });

        if (response.status !== 200) {
            console.error("âŒ ì„œë¡œì´ì›ƒ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ:", response.status);
            return;
        }

        const data = await response.json();
        console.log("ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ ë°ì´í„°:", data);

        // ğŸ”¹ ì„œë¡œì´ì›ƒ ëª©ë¡ì„ UIì— ì¶”ê°€
        const neighborListContainer = document.querySelector(".neighbor-list");
        neighborListContainer.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

        if (data.neighbors.length === 0) {
            neighborListContainer.innerHTML = "<p>ì•„ì§ ì„œë¡œì´ì›ƒì´ ì—†ìŠµë‹ˆë‹¤.</p>";
            return;
        }

        data.neighbors.forEach(neighbor => {
    const neighborDiv = document.createElement("div");
    neighborDiv.style.display = "inline-block";

    const neighborImgDiv = document.createElement("div");
    neighborImgDiv.classList.add("neighbor_img");
    const img = document.createElement("img");

    img.src = getFullMediaUrl(neighbor.user_pic);  // user_picì„ ì ˆëŒ€ ê²½ë¡œë¡œ ë³€í™˜
    img.alt = "ì´ì›ƒ í”„ë¡œí•„";
    neighborImgDiv.appendChild(img);

    const neighborNickname = document.createElement("a");
    neighborNickname.classList.add("neighbor_nickname");
    neighborNickname.innerText = neighbor.urlname;
    neighborNickname.href = `blog.html?user=${encodeURIComponent(neighbor.urlname)}`;

    neighborDiv.appendChild(neighborImgDiv);
    neighborDiv.appendChild(neighborNickname);
    neighborListContainer.appendChild(neighborDiv);
});

    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
    }
});



//ê·¼ë° íƒ€ì¸ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ë°±ì—”ë“œ APIê°€ ë”°ë¡œ í•„ìš”í•œê°€
document.addEventListener("DOMContentLoaded", async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get("user"); // í˜„ì¬ ë³´ê³  ìˆëŠ” ë¸”ë¡œê·¸ ì£¼ì¸

    if (!username) {
        console.error("âŒ ì˜¤ë¥˜: ë¸”ë¡œê·¸ ì£¼ì¸ì˜ usernameì´ ì—†ìŒ");
        return;
    }

    const accessToken = localStorage.getItem("access_token");
    if (!accessToken) {
        console.warn("ğŸš¨ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ, ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™");
        alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        window.location.href = "login.html";
        return;
    }

    try {
        // ğŸ”¹ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ API ìš”ì²­
        const apiUrl = `http://127.0.0.1:8000/category/`;
        console.log("ğŸ”¹ ì¹´í…Œê³ ë¦¬ ëª©ë¡ API í˜¸ì¶œ:", apiUrl);

        const response = await fetch(apiUrl, {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${accessToken}`,
                "Content-Type": "application/json"
            }
        });

        if (response.status !== 200) {
            console.error("âŒ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ:", response.status);
            return;
        }

        const data = await response.json();
        console.log("ğŸ”¹ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ë°ì´í„°:", data);

        // ğŸ”¹ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ UIì— ì¶”ê°€
        const categoryListContainer = document.querySelector(".category-list");
        categoryListContainer.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

        // ê¸°ë³¸ ì „ì²´ë³´ê¸° ì¶”ê°€
        const allCategoryDiv = document.createElement("div");
        allCategoryDiv.innerText = "ì „ì²´ë³´ê¸°";
        allCategoryDiv.classList.add("category-item");
        allCategoryDiv.addEventListener("click", () => {
            window.location.href = `blog.html?user=${encodeURIComponent(username)}`;
        });
        categoryListContainer.appendChild(allCategoryDiv);

        if (data.length === 0) {
            const emptyDiv = document.createElement("div");
            emptyDiv.innerText = "ë“±ë¡ëœ ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.";
            categoryListContainer.appendChild(emptyDiv);
            return;
        }

        data.forEach(category => {
            const categoryDiv = document.createElement("div");
            categoryDiv.innerText = category.name;
            categoryDiv.classList.add("category-item");
            categoryDiv.addEventListener("click", () => {
                window.location.href = `blog.html?user=${encodeURIComponent(username)}&category=${encodeURIComponent(category.id)}`;
            });
            categoryListContainer.appendChild(categoryDiv);
        });

    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
    }
});




</script>


</body>
</html>