<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naver Blog Project</title>
    <style>

        html, body {
            min-width:1280px;
            overflow-y:auto;
            overflow-x: auto;
        }

        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }


/*í—¤ë” ë¶€ë¶„*/        
.header {
            display: flex;
            justify-content: space-between; /* ì¢Œìš°ë¡œ ê· ë“± ë°°ì¹˜ */
            align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
            padding: 5px 17%; /* ì¢Œìš° íŒ¨ë”© ì„¤ì • */
            background-color: #f1d1d3;
            color: white;
        }

        .header .logo {
            display: flex;
            align-items: center;
        }


        .header .logo {
            height: 49px; /* ê³ ì •ëœ ë¡œê³  í¬ê¸° */
            width: auto; /* ë¹„ìœ¨ ìœ ì§€ */
            margin: 1px; /* margin (ì´ë¯¸ì§€ë¥¼ ë‘˜ëŸ¬ì‹¸ëŠ” ì—¬ë°±ì˜ í­) ì œê±° */
            transition: margin-left 0.3s ease;
            font-size:27px;
            font-weight:800;

        }

        .header .search {
            display: flex;
            justify-content: center;
            align-items: center;
        }


        .header .search input {
            width: 60%; /* ê²€ìƒ‰ì°½ ë„ˆë¹„ */
            padding: 12px;
            border: none;
            border-radius: 0px;
            margin-right: 300px;
            border-color: #f1d1d3;

        }

        .header .search button { /*ìœ—ì¤„ ê²€ìƒ‰ ë²„íŠ¼*/
            padding: 11px 13px;
            border: none;
            background-color: #da9d9c;
            border-color: #da9d9c;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            margin-left:0px;
        }

        
        .header .search button:hover {
            background-color: #861f1c;
        }

        .header .menu {
            display: flex;
        }


        .header .menu button {
            background-color: #da9d9c;
            color: #fff;
            border: none;
            padding: 11px 16px;
            border-radius:2px;
            cursor: pointer;
            font-weight: bold;
        }

        .header .menu button:hover {
            background-color: #861f1c;
        }

        .search select {
            width:100%;
            padding:11.8px;
            border: 0.05px solid;
            border-color: #da9d9c;
            margin-right:20px;
        }
        
        .main-container {
    display: flex;
    justify-content: space-between;
    align-items: stretch; /* ë†’ì´ë¥¼ ì»¨í…Œì´ë„ˆ ì „ì²´ë¡œ ëŠ˜ë¦¬ê¸° */
    margin: 20px;
}

/*í—¤ë” ë¶€ë¶„ ì˜¤ë¥¸ìª½ ê³„ì • ì´ë¦„ ë¶€ë¶„*/
        .header-profile img{
            width:38px;
            border-radius:50px;
        }

        .header-profile {
            display:flex;
            flex-direction:row;
            font-size:15px;
        }

        .header-profile-name{
            margin-left:8px;
            margin-top:10px;
            margin-right:80px;
        }



        .header-profile button { /*ìœ—ì¤„ ê²€ìƒ‰ ë²„íŠ¼*/
            padding: 5px 10px;
            border: none;
            background-color: #da9d9c;
            border-color: #da9d9c;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            font-size:14px;
            margin-top:5px;
            margin-right:-150px;
        }
        
        .header-profile button:hover {
            background-color: #861f1c;
        }




/* ì™¼ìª½ ê²Œì‹œê¸€ ë¶€ë¶„ */
.post {
    display: flex;
    align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
    gap: 15px; /* ì´ë¯¸ì§€ì™€ ê¸€ ë‚´ìš© ì‚¬ì´ ê°„ê²© ì¡°ì • */
    padding: 20px 10px;
    border-bottom: 1px solid #ddd;
    margin-top: 20px; /* ìœ„ìª½ ê°„ê²© ì¶”ê°€ */
}

.post:last-child {
    border-bottom: none;
}

.post img {
    width: 80px;  /* ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • */
    height: 80px;
    object-fit: cover; /* ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ í¬ê¸° ì¡°ì • */
    border-radius: 50%;
    flex-shrink: 0; /* í¬ê¸°ê°€ ì¤„ì–´ë“¤ì§€ ì•Šë„ë¡ ì„¤ì • */
}

.post-content {
    flex: 1; /* ë‚´ìš©ì´ ë‚¨ì€ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
    min-width: 0; /* ë‚´ìš©ì´ ë„˜ì¹˜ì§€ ì•Šë„ë¡ ì„¤ì • */
}

.post-author {
    display: flex;
    align-items: center;
    gap: 10px; /* í”„ë¡œí•„ ì‚¬ì§„ê³¼ ë‹‰ë„¤ì„ ì‚¬ì´ ê°„ê²© ì¡°ì • */
}

.post-author img { /*ê²Œì‹œê¸€ ì‘ì„±ì í”„ë¡œí•„ ì‚¬ì§„*/
    width: 38px;
    height: 38px;
    border-radius: 50%;
    margin-right: 4px;
}

.post-title { /*ê²Œì‹œê¸€ ì œëª©*/
    font-size: 17px;
    font-weight: bold;
    margin-bottom: 10px;
    margin-top:16px;
}

.post-text {
    font-size: 14px;
    color: #666;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}

.post-actions { /*ê²Œì‹œê¸€ì—ì„œ ì¢‹ì•„ìš”, ëŒ“ê¸€ ë“± */
    font-size: 12px;
    color: #777;
    margin-top: 8px;
    display: flex;
    align-items: center;
}

.post-actions span {
    margin-right: 8px;
}

.post-actions img {
    width: 16px;
    height: 16px;
}

/* ì™¼ìª½ ê²Œì‹œê¸€ ë¶€ë¶„ ë†’ì´ ëŠ˜ë¦¬ê¸° */
.left-column {
    width: 70%; /* ì™¼ìª½ ë¶€ë¶„ í¬ê¸° ì¡°ì ˆ */
    max-width: 1500px; /* ìµœëŒ€ ë„ˆë¹„ ì œí•œ */
    padding: 25px;
    margin-top: 30px; /* ìƒë‹¨ ì—¬ë°± ì¶”ê°€ */
}

/* ê²Œì‹œë¬¼ ëª©ë¡ ì•„ë˜ìª½ ì—¬ë°± ì¶”ê°€ */
.mutual-posts {
    margin-top: 40px; /* ê²Œì‹œë¬¼ ëª©ë¡ê³¼ ì´ì›ƒ ìƒˆê¸€ ë°•ìŠ¤ ì‚¬ì´ì˜ ê°„ê²©ì„ ë„“í˜ */
}

/* ì´ì›ƒìƒˆê¸€ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
       /* ì´ì›ƒ ìƒˆê¸€ ë°•ìŠ¤ ìœ„ë¡œ ì˜¬ë¦¬ê¸° */
        .new-posts {
        position: relative; /* ìƒëŒ€ ìœ„ì¹˜ë¡œ ì„¤ì • */
        top: -20px; /* ë°•ìŠ¤ë¥¼ ìœ„ë¡œ 20px ì˜¬ë¦¬ê¸° */
        margin-bottom: 20px; /* ì•„ë˜ìª½ ê°„ê²© ì¶”ê°€ */
        z-index: 999;
        }

        /* new-posts ê¸€ì”¨ ì•ˆ ë³´ì´ëŠ” ë¬¸ì œ í•´ê²° */
        .new-posts p {
        font-size: 18px;
        color: #333; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
        font-weight: bold;
        margin-bottom: 20px; /* ì•„ë˜ìª½ ì—¬ë°± ì¶”ê°€ */
        }


/*ê²Œì‹œê¸€ ì‘ì„±ì ê´€ë ¨*/
        .post-author {
            display: flex;
            align-items: center; /* ì„¸ë¡œ ì •ë ¬ ìœ ì§€ */
            gap: 8px; /* í”„ë¡œí•„ ì‚¬ì§„, ì´ë¦„, ë‚ ì§œ ì‚¬ì´ ê°„ê²© */
        }

        .author-info {
            display: flex;
            flex-direction: column; 
        }

        .author-name {
            font-size: 14px;
            font-weight: bold;
        }

        .time {
            font-size: 12px;
            color: gray;
            margin-top:3px;
        }


/*ì¢‹ì•„ìš”*/
        .heart {
            font-size: 16px;
            cursor: pointer;
            transition: color 0.3s ease-in-out;
        }

        .heart.active {
                color: red; /* ì±„ì›Œì§„ í•˜íŠ¸ ìƒ‰ìƒ */
        }


/*ê²Œì‹œê¸€ ë³¸ë¬¸ ë¶€ë¶„*/       
        .post-text {
            max-width: 900px; /* ì›í•˜ëŠ” ìµœëŒ€ ê°€ë¡œ ë„ˆë¹„ ì„¤ì • */
            word-wrap: break-word; /* ê¸´ ë‹¨ì–´ë„ ì¤„ë°”ê¿ˆë˜ë„ë¡ ì„¤ì • */
            overflow-wrap: break-word; /* í…ìŠ¤íŠ¸ê°€ ë°•ìŠ¤ë¥¼ ë„˜ìœ¼ë©´ ìë™ ì¤„ë°”ê¿ˆ */
            white-space: normal; /* ê¸°ë³¸ì ìœ¼ë¡œ ì¤„ë°”ê¿ˆ í—ˆìš© */
            line-height: 1.7; /* ì¤„ ê°„ê²© ì¡°ì ˆ */
        }


/*ì˜¤ë¥¸ìª½*/
.right-sidebar {
    width: 350px; /* ê¸°ì¡´ë³´ë‹¤ ë” ë„“ê²Œ ì„¤ì • */
    height: 1000px; /* ê¸°ì¡´ ë†’ì´ë³´ë‹¤ í™•ì¥ */
    min-height: 100vh; /* ìµœì†Œ ë†’ì´ë¥¼ í™”ë©´ ì „ì²´ ë†’ì´ë¡œ ì„¤ì • */
    flex-shrink: 0; /* í¬ê¸° ì¤„ì–´ë“¤ì§€ ì•Šë„ë¡ ì„¤ì • */
    margin-left: 30px; /* ì™¼ìª½ ì—¬ë°± */
    position: absolute; /* ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê³ ì • */
    right: 8%; /* ê¸°ì¡´ 10% â†’ 8%ë¡œ ë³€ê²½ (ë„ˆë¬´ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë¶™ì§€ ì•Šê²Œ) */
    top: 90px; /* ìœ„ìª½ ì—¬ë°± ì„¤ì • */
    overflow-y: auto; /* ë‚´ìš©ì´ ë§ì•„ì§€ë©´ ìŠ¤í¬ë¡¤ ìƒì„± */
}




        /* í”„ë¡œí•„ ì˜ì—­ */
        .profile {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .profile-left {
            display: flex;
            align-items: center;
        }

        .user-profilepicture {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 16px;
            font-weight: bold;
        }

        .profile-status {
            font-size: 12px;
            color: gray;
        }

        .logout-btn {
            background-color: white;
            border: 1px solid lightgray;
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 5px;
            cursor: pointer;
        }

        .logout-btn:hover {
            background-color: #f0f0f0;
        }

        /* ë©”ë‰´ */
        .menu {
            display: flex;
            margin-bottom: 20px;
        }

        .menu button {
            flex: 1;
            padding: 12px;
            font-size: 14px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .menu button:hover {
            background-color: #861f1c;
        }

        .menu .active {
            background-color: #da9d9c;
            color: white;
        }

        /* ì•Œë¦¼ íƒ­ (ë‚´ ì†Œì‹, ë‚´ í™œë™, ì´ì›ƒ ëª©ë¡)*/
        .notification-tabs {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
            margin-bottom: 13px;
        }

        .notification-tabs div {
            flex: 1;
            text-align: center;
            padding: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }

        .notification-tabs .active {
            border-bottom: 1.5px solid black;
        }

        /* ì•Œë¦¼ ë¦¬ìŠ¤íŠ¸ */
        .notifications {
            margin-bottom: 18px;
        }

        .notification-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-content {
            flex: 1;
        }

        .notification-user {
            font-weight: bold;
            color: #2c8f3b;
        }

        .notification-time {
            font-size: 12px;
            color: gray;
        }

        .delete-btn {
            background: none;
            border: none;
            color: gray;
            cursor: pointer;
            font-size: 16px;
            margin-left:5px;
        }

        .delete-btn:hover {
            color: black;
        }

        /* ëª¨ë‘ ì‚­ì œ ë²„íŠ¼ */
        .delete-all {
            text-align: center;
            padding: 10px;
            background-color: #f8f8f8;
            border-top: 1px solid #ddd;
            cursor: pointer;
            font-size: 14px;
        }

        .delete-all:hover {
            background-color: #f0f0f0;
        }

        /* ì¢‹ì•„ìš”(í•˜íŠ¸) ê¸°ëŠ¥ */
        .heart {
            cursor: pointer;
            font-size: 14px;
        }

        .liked {
            color: red;
        }



/* ì´ì›ƒ ëª©ë¡ ì»¨í…Œì´ë„ˆ */
.neighbor-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

/* ì´ì›ƒ í•­ëª© */
.neighbor-item {
    display: flex;
    align-items: center;  /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
    width: calc(50% - 10px);  /* 1ì¤„ì— 2ëª…ì”© */
    padding: 10px;
    background: #f8f9fa;
    border-radius: 5px;
    margin-bottom: 10px;
}

/* ì´ì›ƒ ë‚´ìš© */
.neighbor-content {
    display: flex;
    flex-direction: row;  /* ì‚¬ì§„ ì™¼ìª½, ë‹‰ë„¤ì„ ì˜¤ë¥¸ìª½ */
    align-items: center;  /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
    justify-content: flex-start;  /* ì™¼ìª½ ì •ë ¬ */
    width: 100%; /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
}

/* í”„ë¡œí•„ ì´ë¯¸ì§€ */
.neighbor-profile {
    width: 35px;  /* í¬ê¸° ì¡°ì • */
    height: 35px;
    border-radius: 50%;
    margin-right: 10px;  /* ì´ë¯¸ì§€ ì˜¤ë¥¸ìª½ ê°„ê²© */
    flex-shrink: 0; /* í¬ê¸° ê³ ì • */
}

/* ë‹‰ë„¤ì„ ìŠ¤íƒ€ì¼ */
.neighbor-name {
    font-size: 14px;  /* ê¸€ì í¬ê¸° */
    font-weight: bold;
    text-align: left;  /* ì™¼ìª½ ì •ë ¬ */
    white-space: nowrap; /* ë‹‰ë„¤ì„ì´ ì¤„ ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ ì„¤ì • */
    overflow: hidden; /* ë„ˆë¬´ ê¸¸ë©´ ìˆ¨ê¹€ */
    text-overflow: ellipsis; /* ìƒëµ ë¶€í˜¸(...) ì¶”ê°€ */
}

.left-column {
    margin-top:-5px;
    margin-bottom:5px;
    margin-left:25px;
    font-size:20px;
    font-weight:700;
}


    </style>
</head>

    <header class="header">
        <!-- ë¡œê³  -->
        <div class="logo">SG blog</div>

        <!-- ê²€ìƒ‰ ì˜ì—­ -->
        <div class="search">
            <div class="search-select">
                <label for="search-type" class="visually-hidden"></label>
                <select id="search-type" name="type">
                    <option value="geul">ê¸€</option>
                    <option value="blog">ë¸”ë¡œê·¸</option>
                    <option value="id">ë³„ëª…, ì•„ì´ë””</option>
                </select>
            </div>
            <button class="search-button">ë¡œ ê²€ìƒ‰í•˜ê¸°</button>
        </div>

        <!-- ë©”ë‰´ ë²„íŠ¼ -->
        <div class="header-profile">
            <button class="header-profile-setting" onclick="location.href='profile.html'">í”„ë¡œí•„ ìˆ˜ì •</button>
        </div>
    </header>

    <div class="main-container">
        <div class="left-column">
           ì´ì›ƒ ìƒˆê¸€ 
             <div class="new-posts">
            </div>
        </div>

        <div class="right-sidebar">
            <!-- í”„ë¡œí•„ ì •ë³´ -->
            <div class="profile">
                <div class="profile-left">
                    <!-- í”„ë¡œí•„ ì‚¬ì§„ ë³€ê²½ -->
                    <img class="user-profilepicture" id="profile-image" src="assets/profile.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
                    <div class="profile-info">
                        <span class="profile-name user-nickname" id="user-nickname"></span> <!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì´ë¦„ í‘œì‹œ -->
                    </div>
                </div>
                <button class="logout-btn" onclick="location.href='main.html'">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
            <!-- ë©”ë‰´ -->
            <div class="menu">
                <button class="active" onclick="location.href='myprolog.html'">ë‚´ ë¸”ë¡œê·¸</button>
                <button onclick="location.href='write.html'">âœ ê¸€ì“°ê¸°</button>
            </div>
        
            <!-- ì•Œë¦¼ íƒ­ -->
            <div class="notification-tabs">
                <div class="tab active" data-tab="news">ë‚´ ì†Œì‹</div>
                <div class="tab" data-tab="activity">ë‚´ í™œë™</div>
                <div class="tab" data-tab="neighbors">ì´ì›ƒ ëª©ë¡</div>
            </div>
        
            <!-- ì•Œë¦¼ ë¦¬ìŠ¤íŠ¸ -->
            <div class="notifications">
                <!-- ì—¬ê¸°ì— JavaScriptê°€ ë°±ì—”ë“œì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ë™ì ìœ¼ë¡œ ì¶”ê°€í•  ê±°ì„ -->
            </div>
        </div>
    </div>
        <script>
            // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ í”„ë¡œí•„ ì •ë³´ë¥¼ ë°›ì•„ì˜¤ëŠ” í•¨ìˆ˜
async function fetchUserProfile() {
    try {
        const response = await fetch("http://127.0.0.1:8000/profile/me/", {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${localStorage.getItem("access_token")}`,
                "Content-Type": "application/json"
            }
        });

        if (response.status === 200) {
            const userData = await response.json();
            const userNickname = userData.username;
            const userPic = userData.user_pic;

            // í”„ë¡œí•„ ì´ë¯¸ì§€ ê²½ë¡œ ì„¤ì •
            let fullImageUrl;
            if (userPic && userPic.includes('user_pics')) {
                fullImageUrl = `http://127.0.0.1:8000${userPic}`;
            } else {
                fullImageUrl = `http://127.0.0.1:8000/media/default/user_default.jpg`;
            }

            // í”„ë¡œí•„ ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById("user-nickname").textContent = userNickname;
            document.getElementById("profile-image").src = fullImageUrl;
        } else {
            console.log("âŒ ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", response.status);
        }
    } catch (error) {
        console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
    }
}

// í˜ì´ì§€ê°€ ë¡œë“œëœ í›„ í”„ë¡œí•„ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
document.addEventListener("DOMContentLoaded", fetchUserProfile);

         document.addEventListener("DOMContentLoaded", async function () {
    const accessToken = localStorage.getItem("access_token");
    if (!accessToken) {
        alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        window.location.href = "login.html";
        return;
    }

    const userUrlname = await getUserUrlname(); // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ urlname ê°€ì ¸ì˜¤ê¸°

    // API ì—”ë“œí¬ì¸íŠ¸ ì„¤ì • (ì´ì›ƒ ëª©ë¡ì€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì— ë”°ë¼ ë™ì  URL ì ìš©)
    const API_ENDPOINTS = {
        news: "http://127.0.0.1:8000/news/list/",
        activity: "http://127.0.0.1:8000/activity/list/",
        neighbors: `http://127.0.0.1:8000/profile/${userUrlname}/neighbors/` // ë°±í‹± ì‚¬ìš©
    };

    const notificationsContainer = document.querySelector(".notifications");
    const tabs = document.querySelectorAll(".tab");

    // íƒ­ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
    tabs.forEach(tab => {
        tab.addEventListener("click", function () {
            tabs.forEach(t => t.classList.remove("active"));
            tab.classList.add("active");

            const tabType = tab.getAttribute("data-tab");
            fetchNotifications(API_ENDPOINTS[tabType], tabType);
        });
    });

    // ì•Œë¦¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
    async function fetchNotifications(apiUrl, tabType) {
        try {
            const response = await fetch(apiUrl, { // API í˜¸ì¶œ URL ìˆ˜ì •
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${accessToken}`,
                    "Content-Type": "application/json"
                }
            });

            if (response.status === 200) {
                const data = await response.json();
                console.log(`ğŸ“¢ ${apiUrl} ë°ì´í„°:`, data);

                notificationsContainer.innerHTML = ""; // ê¸°ì¡´ ë°ì´í„° ì´ˆê¸°í™”

                if (tabType === "neighbors") {
                    // "ì´ì›ƒ ëª©ë¡" ì²˜ë¦¬ (1ì¤„ì— 2ëª…ì”© í‘œì‹œí•˜ê³  user_pic ì¶”ê°€)
                    const neighborContainer = document.createElement("div");
                    neighborContainer.classList.add("neighbor-container");

                    data.neighbors.forEach((neighbor, index) => {
                        const { username, user_pic } = neighbor;

                        // user_pic ê²½ë¡œ ì„¤ì •: ê¸°ë³¸ ì‚¬ì§„(default)ì¸ì§€, ì‚¬ìš©ì ì‚¬ì§„(user_pics)ì¸ì§€ í™•ì¸
                        let fullImageUrl;
                        if (user_pic && user_pic.includes('user_pics')) {
                            fullImageUrl = `http://127.0.0.1:8000${user_pic}`;
                        } else {
                            fullImageUrl = `http://127.0.0.1:8000/media/default/user_default.jpg`;
                        }

                        const neighborItem = document.createElement("div");
                        neighborItem.classList.add("neighbor-item");
                        neighborItem.innerHTML = `
                            <div class="neighbor-content">
                                <img src="${fullImageUrl}" alt="${username}" class="neighbor-profile">
                                <span class="neighbor-name">${username}</span>
                            </div>
                        `;

                        // ì§ìˆ˜ ë²ˆì§¸ ì•„ì´í…œì— ì¤„ë°”ê¿ˆ ì¶”ê°€ (1ì¤„ì— 2ëª…ì”©)
                        if (index % 2 === 0 && index !== 0) {
                            neighborContainer.appendChild(document.createElement("br"));
                        }

                        // DOMì— ì¶”ê°€
                        neighborContainer.appendChild(neighborItem);
                    });

                    notificationsContainer.appendChild(neighborContainer);

                } else {
                // "ë‚´ ì†Œì‹" & "ë‚´ í™œë™" ì²˜ë¦¬ (ì•„ì´ì½˜ ë‹¤ë¥´ê²Œ ì„¤ì •)
                data.forEach(activity => {
                    const { type, content, created_at, is_parent } = activity;

                    let icon = "";
                    if (type === "written_comment"||type==="post_comment") {
                        icon = `<span class="icon comment">ğŸ’¬</span>`; // ëŒ“ê¸€ ì•„ì´ì½˜
                    } else if (type === "written_reply"||type==="comment_reply") {
                        icon = `<span class="icon reply">â†©</span>`; // ëŒ€ëŒ“ê¸€ ì•„ì´ì½˜
                    } else if (type === "post_like" || type === "liked_post"||type==="liked_comment") {
                        icon = `<span class="icon like">â¤ï¸</span>`; // ì¢‹ì•„ìš” ì•„ì´ì½˜
                    }

                        // ë‚ ì§œ í¬ë§· ë³€ê²½ (YYYY. M. D. HH:mm)
                        let dateObj = new Date(created_at);
                        let formattedDate = `${dateObj.getFullYear()}. ${dateObj.getMonth() + 1}. ${dateObj.getDate()} ${dateObj.getHours()}:${String(dateObj.getMinutes()).padStart(2, '0')}`;

                        // ì•Œë¦¼ HTML ìƒì„±
                        const notificationItem = document.createElement("div");
                        notificationItem.classList.add("notification-item");
                        notificationItem.innerHTML = `
                            <div class="notification-content">
                                ${icon} <span class="notification-user">${content}</span>
                                <div class="notification-time">${formattedDate}</div>
                            </div>
                        `;

                        notificationsContainer.appendChild(notificationItem);
                    });
                }

            } else {
                alert("ì•Œë¦¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                console.log(`âŒ ${apiUrl} ì‘ë‹µ ìƒíƒœ ì½”ë“œ:`, response.status);
            }
        } catch (error) {
            console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
            alert("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    }

    // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ urlname ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
    async function getUserUrlname() {
        try {
            const response = await fetch("http://127.0.0.1:8000/profile/me/", {
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${localStorage.getItem("access_token")}`,
                    "Content-Type": "application/json"
                }
            });

            if (response.status === 200) {
                const userData = await response.json();
                return userData.urlname; // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ urlname ë°˜í™˜
            } else {
                console.log("âŒ ì‚¬ìš©ì ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", response.status);
                return null;
            }
        } catch (error) {
            console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
            return null;
        }
    }

    // ê¸°ë³¸ì ìœ¼ë¡œ "ë‚´ ì†Œì‹" ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸°
    fetchNotifications(API_ENDPOINTS.news, "news");
});



            document.addEventListener("DOMContentLoaded", async function () {
    const accessToken = localStorage.getItem("access_token");
    if (!accessToken) {
        alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        window.location.href = "login.html";
        return;
    }

    const API_ENDPOINTS = {
        mutualPosts: "http://127.0.0.1:8000/posts/mutual/recentweekly/",
    };

    const postsContainer = document.querySelector(".new-posts"); // ê²Œì‹œê¸€ì´ ì¶”ê°€ë  ì»¨í…Œì´ë„ˆ

    // ê²Œì‹œë¬¼ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
    async function fetchMutualPosts() {
        try {
            const response = await fetch(API_ENDPOINTS.mutualPosts, {
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${accessToken}`,
                    "Content-Type": "application/json"
                }
            });

            if (response.status === 200) {
                const data = await response.json();
                console.log("ğŸ“¢ ë°›ì€ ë°ì´í„°:", data);

                // ê¸°ì¡´ ê²Œì‹œë¬¼ ì´ˆê¸°í™”
                postsContainer.innerHTML = "";

                // ë°ì´í„° ìˆœíšŒí•˜ì—¬ HTML ë™ì ìœ¼ë¡œ ìƒì„±
                data.forEach(post => {
                    const { user_name, user_pic, title, content, total_likes, total_comments, created_at } = post;

                    // ğŸ› ï¸ user_pic ê²½ë¡œ ì„¤ì • (ê¸°ë³¸ ì‚¬ì§„ ë˜ëŠ” ì‚¬ìš©ì ì‚¬ì§„)
                    let fullImageUrl = "http://127.0.0.1:8000/media/default/user_default.jpg"; // ê¸°ë³¸ê°’ ì„¤ì •
                    if (user_pic) {
                        if (user_pic.startsWith("/media/")) {
                            fullImageUrl = `http://127.0.0.1:8000${user_pic}`;
                        }
                    }

                    console.log(`âœ… ${user_name}ì˜ ì´ë¯¸ì§€:`, fullImageUrl);

                    // ë‚ ì§œ í¬ë§·
                    let dateObj = new Date(created_at);
                    let formattedDate = `${dateObj.getFullYear()}. ${dateObj.getMonth() + 1}. ${dateObj.getDate()} ${dateObj.getHours()}:${String(dateObj.getMinutes()).padStart(2, '0')}`;

                    // ê²Œì‹œê¸€ HTML ìƒì„±
                    const postHTML = `
                        <div class="post">
                            <div class="post-content">
                                <div class="post-author">
                                    <img src="${fullImageUrl}" alt="${user_name}" class="profile-pic">
                                    <div class="author-info">
                                        <span class="author-name">${user_name}</span>
                                        <span class="time">${formattedDate}</span>
                                    </div>
                                </div>
                                <div class="post-title">${title}</div>
                                <div class="post-text">${content}</div>
                                <div class="post-actions">
                                    <span class="heart">ğŸ¤</span>
                                    <span class="heart-count">${total_likes}</span>
                                    <span>ğŸ’¬ ${total_comments}</span>
                                </div>
                            </div>
                            <img src="assets/profile.png" alt="í¬ìŠ¤íŠ¸ ì´ë¯¸ì§€">
                        </div>
                    `;

                    postsContainer.innerHTML += postHTML;
                });

            } else {
                alert("ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                console.log(`âŒ ì‘ë‹µ ìƒíƒœ ì½”ë“œ:`, response.status);
            }
        } catch (error) {
            console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
            alert("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    }

    // ê¸°ë³¸ì ìœ¼ë¡œ "ì„œë¡œì´ì›ƒ ê²Œì‹œê¸€"ì„ ë¶ˆëŸ¬ì˜¤ê¸°
    fetchMutualPosts();
});







document.addEventListener("DOMContentLoaded", async function () {
                const accessToken = localStorage.getItem("access_token");
                if (!accessToken) {
                    alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
                    window.location.href = "login.html";
                    return;
                }
            
                try {
                    const response = await fetch("http://127.0.0.1:8000/profile/me/", {
                        method: "GET",
                        headers: {
                            "Authorization": `Bearer ${accessToken}`,
                            "Content-Type": "application/json"
                        }
                    });
            
                    if (response.status === 200) {
                        const data = await response.json();
                        const nickname = data.username || "ìœ ë‚˜"; // ë‹‰ë„¤ì„ ê°€ì ¸ì˜¤ê¸°
                        const profilePic = data.user_pic || "assets/profile.png"; // í”„ë¡œí•„ ì‚¬ì§„ ê°€ì ¸ì˜¤ê¸°
            
                        // ğŸ”¥ ë‹‰ë„¤ì„ ë³€ê²½
                        document.querySelectorAll(".user-nickname").forEach(el => {
                            el.innerText = nickname;
                        });
            
                        // ğŸ”¥ í”„ë¡œí•„ ì‚¬ì§„ ë³€ê²½
                        document.querySelectorAll(".user-profilepicture").forEach(img => {
                            img.src = profilePic;
                        });

                        document.querySelectorAll(".itemtitlefont").forEach(e2 => {
                                e2.innerText = blogname;
                            });
            
                    } else {
                        alert("ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                        console.log("âŒ ì‘ë‹µ ìƒíƒœ ì½”ë“œ:", response.status);
                    }
                } catch (error) {
                    console.error("âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜:", error);
                    alert("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                }
            });
            


        function toggleHeart(element) {
            let heartCount = element.nextElementSibling; // ë°”ë¡œ ë‹¤ìŒ ìš”ì†Œ (heart-count)
            let count = parseInt(heartCount.innerText); // í˜„ì¬ ìˆ«ì ê°€ì ¸ì˜¤ê¸°
        
            if (element.innerText === "ğŸ¤") {
                element.innerText = "â¤ï¸"; // ì±„ì›Œì§„ í•˜íŠ¸ë¡œ ë³€ê²½
                element.classList.add("active");
                heartCount.innerText = count + 1; // ìˆ«ì ì¦ê°€
            } else {
                element.innerText = "ğŸ¤"; // ë‹¤ì‹œ ë¹„ì–´ìˆëŠ” í•˜íŠ¸ë¡œ ë³€ê²½
                element.classList.remove("active");
                heartCount.innerText = count - 1; // ìˆ«ì ê°ì†Œ
            }
        }






        document.addEventListener("DOMContentLoaded", function () {
    executeSearch(); // í˜ì´ì§€ê°€ ë¡œë“œë˜ë©´ ê²€ìƒ‰ ì‹¤í–‰
});

function executeSearch() {
    const urlParams = new URLSearchParams(window.location.search);
    const searchType = urlParams.get("type"); // ê²€ìƒ‰ ìœ í˜• (geul, blog, id)
    const searchQuery = urlParams.get("query"); // ê²€ìƒ‰ì–´


    console.log(`ğŸ”¹ ê²€ìƒ‰ ìœ í˜•: ${searchType}, ê²€ìƒ‰ì–´: ${searchQuery}`);

    // ğŸ”¹ ê²€ìƒ‰ì°½ì— ìë™ ì…ë ¥
    document.getElementById("search-input").value = searchQuery;
    document.getElementById("search-type").value = searchType;

    // ğŸ”¹ ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ
    document.querySelector('.post-list').innerHTML = "<p>ê²€ìƒ‰ ì¤‘...</p>";

    // ğŸ”¹ ë°±ì—”ë“œì—ì„œ ê²€ìƒ‰ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
    fetch(`http://127.0.0.1:8000/search?type=${encodeURIComponent(searchType)}&query=${encodeURIComponent(searchQuery)}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            document.querySelector('.post-list').innerHTML = ""; // ë¡œë”© ë©”ì‹œì§€ ì œê±°
            renderSearchResults(searchType, data);
        })
        .catch(error => {
            console.error("âŒ ê²€ìƒ‰ ê²°ê³¼ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", error);
            document.querySelector('.post-list').innerHTML = "<p>ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>";
        });
}


document.addEventListener("DOMContentLoaded", function () {
    const searchButton = document.querySelector(".search-button");
    const searchTypeSelect = document.getElementById("search-type");

    searchButton.addEventListener("click", async function () {
        const searchType = searchTypeSelect.value; // ì„ íƒí•œ ê²€ìƒ‰ ìœ í˜•
        const accessToken = localStorage.getItem("access_token"); // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì í† í°
        let loggedInUser = "";

        if (accessToken) {
            try {
                // ğŸ”¹ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const response = await fetch("http://127.0.0.1:8000/profile/me/", {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${accessToken}`,
                        "Content-Type": "application/json"
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    loggedInUser = encodeURIComponent(data.username);
                } else {
                    console.error("ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                }
            } catch (error) {
                console.error("ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:", error);
            }
        }

        // ğŸ”¹ ê²€ìƒ‰ í˜ì´ì§€ë¡œ ì´ë™ (ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì •ë³´ í¬í•¨)
        redirectToSearch(searchType, loggedInUser);
    });

    function redirectToSearch(searchType, username) {
        console.log(`ğŸ”¹ ê²€ìƒ‰ ì‹¤í–‰: ${searchType}, ë¡œê·¸ì¸ëœ ì‚¬ìš©ì: ${username}`);

        let url = `search.html?type=${encodeURIComponent(searchType)}`;
        if (username) {
            url += `&loggedUser=${username}`;
        }

        window.location.href = url;
    }
});









        </script>
        
</body>
</html>